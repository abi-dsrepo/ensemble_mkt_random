import pytest
import pandas as pd
import os

path = os.getcwd()
@pytest.fixture()
def orders_df():
    #return pd.read_csv(os.path.join(path, 'tests/data/machine_learning_challenge_order_data.csv.gz'))
    data = {'customer_id': {0: '000097eabfd9',
                            1: '0000e2c6d9be',
                            2: '000133bb597f',
                            3: '00018269939b',
                            4: '0001a00468a6',
                            5: '0001d9036b5e',
                            6: '0001d9036b5e',
                            7: '0001d9036b5e',
                            8: '0001e1e04d7d',
                            9: '0001e1e04d7d'},
            'order_date': {0: '2015-06-20',
                            1: '2016-01-29',
                            2: '2017-02-26',
                            3: '2017-02-05',
                            4: '2015-08-04',
                            5: '2015-08-29',
                            6: '2017-01-04',
                            7: '2017-01-28',
                            8: '2015-10-24',
                            9: '2016-03-24'},
            'order_hour': {0: 19,
                            1: 20,
                            2: 19,
                            3: 17,
                            4: 19,
                            5: 19,
                            6: 17,
                            7: 16,
                            8: 19,
                            9: 19},
            'customer_order_rank': {0: 1.0,
                                    1: 1.0,
                                    2: 1.0,
                                    3: 1.0,
                                    4: 1.0,
                                    5: 1.0,
                                    6: 2.0,
                                    7: 3.0,
                                    8: 1.0,
                                    9: 2.0},
            'is_failed': {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0},
            'voucher_amount': {0: 0.0,
                                1: 0.0,
                                2: 0.0,
                                3: 0.0,
                                4: 0.0,
                                5: 0.0,
                                6: 0.0,
                                7: 0.0,
                                8: 0.0,
                                9: 0.0},
            'delivery_fee': {0: 0.0,
                                1: 0.0,
                                2: 0.493,
                                3: 0.493,
                                4: 0.493,
                                5: 0.0,
                                6: 0.0,
                                7: 0.0,
                                8: 0.0,
                                9: 0.0},
            'amount_paid': {0: 11.4696,
                            1: 9.558,
                            2: 5.93658,
                            3: 9.8235,
                            4: 5.1507,
                            5: 11.9475,
                            6: 11.151,
                            7: 9.7173,
                            8: 25.2225,
                            9: 9.2925},
            'restaurant_id': {0: 5803498,
                                1: 239303498,
                                2: 206463498,
                                3: 36613498,
                                4: 225853498,
                                5: 193643498,
                                6: 193643498,
                                7: 193643498,
                                8: 144833498,
                                9: 95953498},
            'city_id': {0: 20326,
                        1: 76547,
                        2: 33833,
                        3: 99315,
                        4: 16456,
                        5: 88276,
                        6: 88276,
                        7: 88276,
                        8: 45358,
                        9: 45358},
            'payment_id': {0: 1779,
                            1: 1619,
                            2: 1619,
                            3: 1619,
                            4: 1619,
                            5: 1619,
                            6: 1619,
                            7: 1619,
                            8: 1619,
                            9: 1619},
            'platform_id': {0: 30231,
                            1: 30359,
                            2: 30359,
                            3: 30359,
                            4: 29463,
                            5: 29463,
                            6: 29463,
                            7: 30359,
                            8: 29463,
                            9: 29463},
            'transmission_id': {0: 4356,
                                1: 4356,
                                2: 4324,
                                3: 4356,
                                4: 4356,
                                5: 4356,
                                6: 4356,
                                7: 4356,
                                8: 4356,
                                9: 4324}}

    return pd.DataFrame.from_dict(data)

@pytest.fixture()
def labels_df():
    data = {'customer_id': {0: '000097eabfd9',
                            1: '0000e2c6d9be',
                            2: '000133bb597f',
                            3: '00018269939b',
                            4: '0001a00468a6',
                            5: '0001d9036b5e',
                            6: '0001e1e04d7d',
                            7: '000235bf6618',
                            8: '0003647e5641',
                            9: '000387b95c2c'},
                            'is_returning_customer': {0: 0,
                                                        1: 0,
                                                        2: 1,
                                                        3: 0,
                                                        4: 0,
                                                        5: 0,
                                                        6: 1,
                                                        7: 0,
                                                        8: 1,
                                                        9: 0}}
    return pd.DataFrame.from_dict(data)
